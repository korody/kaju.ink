<% if @thumbnail.new_record? %>
  alert("pera que deu pÃªra! <%= j @thumbnail.errors.full_messages.join(', ').html_safe %>");
<% else %>
  $(".thumbnails-list").children(".row").append("<%= j render @thumbnail %>");
  var form  = $('*[data-thumbable="<%= @thumbnail.thumbable_type %>"]'),
      field = form.find('.thumbable_thumbnail_ids');

  var array = field.val().split(',').filter(function (v) {
    return !isNaN(parseInt(v));
  });
  array.push('<%= @thumbnail.id %>');

  field.val(array.join(','));
<% end %>
$('.progress').remove();